<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Cluster analysis of potato cultivars | Nutrient Diagnosis Of Potato</title>
  <meta name="description" content="This is a example of using the bookdown package to write a book that describ the statistical computations of my PhD Project, for publication on Github. The output format choosed is bookdown::gitbook. Next features are set out for after (bibliography and links)." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Cluster analysis of potato cultivars | Nutrient Diagnosis Of Potato" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a example of using the bookdown package to write a book that describ the statistical computations of my PhD Project, for publication on Github. The output format choosed is bookdown::gitbook. Next features are set out for after (bibliography and links)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Cluster analysis of potato cultivars | Nutrient Diagnosis Of Potato" />
  
  <meta name="twitter:description" content="This is a example of using the bookdown package to write a book that describ the statistical computations of my PhD Project, for publication on Github. The output format choosed is bookdown::gitbook. Next features are set out for after (bibliography and links)." />
  

<meta name="author" content="zcoulibali" />


<meta name="date" content="2019-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html">
<link rel="next" href="Chapter-Modeling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Data processing</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#Objective"><i class="fa fa-check"></i><b>1.1</b> Ojective</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#useful-libraries-for-data-handling"><i class="fa fa-check"></i><b>1.2</b> Useful libraries for data handling</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#quebec-potato-data-set"><i class="fa fa-check"></i><b>1.3</b> Québec potato data set</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#selection-of-useful-variables"><i class="fa fa-check"></i><b>1.4</b> Selection of useful variables</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#arranging-the-data-frame"><i class="fa fa-check"></i><b>1.5</b> Arranging the data frame</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#cultivars-classes-correction."><i class="fa fa-check"></i><b>1.6</b> Cultivars classes correction.</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#summarise-and-backup"><i class="fa fa-check"></i><b>1.7</b> Summarise and backup</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html"><i class="fa fa-check"></i><b>2</b> Cluster analysis of potato cultivars</a><ul>
<li class="chapter" data-level="2.1" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#objective"><i class="fa fa-check"></i><b>2.1</b> Objective</a></li>
<li class="chapter" data-level="2.2" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#useful-libraries-and-custom-functions"><i class="fa fa-check"></i><b>2.2</b> Useful libraries and custom functions</a></li>
<li class="chapter" data-level="2.3" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#leaves-processed-compositions-data-set"><i class="fa fa-check"></i><b>2.3</b> Leaves processed compositions data set</a></li>
<li class="chapter" data-level="2.4" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#high-yielders-delimiter"><i class="fa fa-check"></i><b>2.4</b> High yielders delimiter</a></li>
<li class="chapter" data-level="2.5" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#clr-centroids-computation"><i class="fa fa-check"></i><b>2.5</b> <code>clr</code> centroids computation</a></li>
<li class="chapter" data-level="2.6" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#axis-reduction"><i class="fa fa-check"></i><b>2.6</b> Axis reduction</a></li>
<li class="chapter" data-level="2.7" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#cascade-k-means-clustering"><i class="fa fa-check"></i><b>2.7</b> Cascade K Means clustering</a></li>
<li class="chapter" data-level="2.8" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#arranging-data-for-machine-learning"><i class="fa fa-check"></i><b>2.8</b> Arranging data for Machine Learning</a></li>
<li class="chapter" data-level="2.9" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#clr-x-ionomics-groups-interactions-effects"><i class="fa fa-check"></i><b>2.9</b> clr X ionomics groups interactions effects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html"><i class="fa fa-check"></i><b>3</b> Predicting marketable tuber yield</a><ul>
<li class="chapter" data-level="3.1" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#load-data-file"><i class="fa fa-check"></i><b>3.1</b> Load data file</a></li>
<li class="chapter" data-level="3.2" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#machine-learning"><i class="fa fa-check"></i><b>3.2</b> Machine learning</a></li>
<li class="chapter" data-level="3.3" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#assessing-goodness-of-fit"><i class="fa fa-check"></i><b>3.3</b> Assessing goodness of fit</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chapter-Perturbation-vector.html"><a href="Chapter-Perturbation-vector.html"><i class="fa fa-check"></i><b>4</b> Perturbation vector theory</a><ul>
<li class="chapter" data-level="4.1" data-path="Chapter-Perturbation-vector.html"><a href="Chapter-Perturbation-vector.html#dissimilarity-index-between-compositions"><i class="fa fa-check"></i><b>4.1</b> Dissimilarity index between compositions</a></li>
<li class="chapter" data-level="4.2" data-path="Chapter-Perturbation-vector.html"><a href="Chapter-Perturbation-vector.html#rebalancing-a-misbalanced-sample-by-perturbation"><i class="fa fa-check"></i><b>4.2</b> Rebalancing a misbalanced sample by perturbation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Nutrient Diagnosis Of Potato</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter-Clustering" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Cluster analysis of potato cultivars</h1>
<div id="objective" class="section level2">
<h2><span class="header-section-number">2.1</span> Objective</h2>
<hr />
<p>Although plant health is a continuous domain rather than a categorical status, yield thresholds are useful for decision-making. Because yield potential varies widely among cultivars, I use this chapter to split experimental data into low- and high-productivity categories using a marketable yield delimiter at the 65th percentile for each cultivar. Hence, I use high yielders subpopulation (samples which marketable yield is larger than the yield cut-off) to perform a cascade k-means clustering aiming to discriminate Groups of similar multivariate compositions (<code>ionomics groups</code>). I combine a discriminant analysis to check the macroelements that best discriminate cultivars. I also check the performence of Groups discrimination by computing the <code>Groups X clr-coordinates</code> interaction effect coefficients in a linear mixed effect model. I finally append the new variable <code>ionomicGroup</code>to the leaves clr data frame and discard all the rows with any missing data. I map the experimental sites locations in the third sudsection of this chapter. The output data file is called <code>leaf_ml_df.csv</code> i.e., the data frame for machine learning chapter <a href="Chapter-Modeling.html#Chapter-Modeling">3</a>. ***</p>
</div>
<div id="useful-libraries-and-custom-functions" class="section level2">
<h2><span class="header-section-number">2.2</span> Useful libraries and custom functions</h2>
<p>We need a set of packages for data handling and visualization like the <code>tidyverse</code> package presented in previous chapter <a href="index.html#Chapter-Data-Processing">1</a>, <a href="https://rdrr.io/cran/ellipse/">ellipse</a> offers functions for drawing ellipses and ellipse-Like confidence regions (maybe I will set this option to FLASE for graph simplicity), <a href="https://rdrr.io/cran/mvoutlier/">mvoutlier</a> for multivariate outliers detection, <a href="http://pbil.univ-lyon1.fr/ADE-4">ade4</a> gathers tools for multivariate data analysis (I use it for discriminant analysis), <a href="https://rdrr.io/cran/vegan/">vegan</a> performs cluster analysis by k-means or cascade k-means clustering, <a href="https://github.com/dkahle/ggmap">ggmap</a> makes it easy to retrieve raster map tiles from online mapping services like Google Maps and Stamen Maps and plot them using the ggplot2 framework, <a href="https://www.r-pkg.org/pkg/extrafont">extrafont</a> for custom fonts for graphs with ggplot2, <a href="https://github.com/slowkow/ggrepel">ggrepel</a> provides text and label geoms for ‘ggplot2’ that help to avoid overlapping text labels, <a href="https://plotly-r.com">plotly</a> …, <a href="https://www.rdocumentation.org/packages/nlme">nlme</a> for linear and non-linear mixed effect modeling. Some custom functions are also loaded mainly for Pseudo r-square caculation with linear mixed effect model and discriminant biplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&#39;ellipse&#39;</span>)
<span class="kw">library</span>(<span class="st">&quot;mvoutlier&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ade4&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;vegan&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;extrafont&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggrepel&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggmap&quot;</span>)
<span class="co">#library(&quot;plotly&quot;)</span>
<span class="kw">library</span>(<span class="st">&quot;nlme&quot;</span>)
<span class="kw">source</span>(<span class="st">&quot;data/functions.R&quot;</span>)
<span class="kw">source</span>(<span class="st">&#39;https://raw.githubusercontent.com/essicolo/AgFun/master/plotDA_trad.R&#39;</span>)</code></pre></div>
</div>
<div id="leaves-processed-compositions-data-set" class="section level2">
<h2><span class="header-section-number">2.3</span> Leaves processed compositions data set</h2>
<p>For this chapter, the initial data set is the outcome of the prvious chapter (<a href="index.html#Chapter-Data-Processing">1</a>) <code>leaf_clust_df</code>. I load the data frame and create vectors of columns I will use in this chapter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">leaf_clust_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;output/leaf_clust_df.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   NoEssai = col_double(),
##   NoBloc = col_double(),
##   NoTraitement = col_double(),
##   Annee = col_double(),
##   LatDD = col_double(),
##   LonDD = col_double(),
##   AnalyseFoliaireStade = col_character(),
##   Cultivar = col_character(),
##   Maturity5 = col_character(),
##   RendVendable = col_double(),
##   leaf_countNA = col_double(),
##   clr_N = col_double(),
##   clr_P = col_double(),
##   clr_K = col_double(),
##   clr_Ca = col_double(),
##   clr_Mg = col_double(),
##   clr_Fv = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">keys_col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;NoEssai&#39;</span>, <span class="st">&#39;NoBloc&#39;</span>, <span class="st">&#39;NoTraitement&#39;</span>)
clr_no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clr_N&quot;</span>, <span class="st">&quot;clr_P&quot;</span>, <span class="st">&quot;clr_K&quot;</span>, <span class="st">&quot;clr_Mg&quot;</span>, <span class="st">&quot;clr_Ca&quot;</span>, <span class="st">&quot;clr_Fv&quot;</span>)
cultivarAndyield &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Cultivar&#39;</span>, <span class="st">&#39;Maturity5&#39;</span>, <span class="st">&#39;RendVendable&#39;</span>)
extra_col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;LatDD&#39;</span>, <span class="st">&#39;LonDD&#39;</span>, <span class="st">&#39;AnalyseFoliaireStade&#39;</span>)</code></pre></div>
<p>The next cell maps experimental sites locations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(&quot;ggmap&quot;)</span>
qc_leaf &lt;-<span class="st"> </span><span class="kw">get_stamenmap</span>(<span class="dt">bbox =</span> <span class="kw">c</span>(<span class="dt">left=</span><span class="op">-</span><span class="dv">76</span>, <span class="dt">right=</span><span class="op">-</span><span class="dv">68</span>, <span class="dt">bottom=</span><span class="dv">45</span>, <span class="dt">top=</span><span class="dv">50</span>), 
                        <span class="dt">zoom=</span><span class="dv">7</span>, <span class="dt">maptype =</span> <span class="st">&#39;toner-lite&#39;</span>)
<span class="kw">ggmap</span>(qc_leaf) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">select</span>(LonDD, LatDD) <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">unique</span>(), <span class="kw">aes</span>(<span class="dt">x =</span> LonDD, <span class="dt">y =</span> LatDD),
             <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;mercator&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Arial&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>))</code></pre></div>
<div class="figure" style="text-align: center">
<img src="2019_Bookdown_files/figure-html/leaf_df-sites-locations-1.png" alt="Location of experimental sites (green dots) in the Québec potato data set." width="100%" />
<p class="caption">
(#fig:leaf_df-sites-locations)Location of experimental sites (green dots) in the Québec potato data set.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ggsave(&quot;images/leaf_clust_df-sites-locations.png&quot;, width=10, height=8)</span></code></pre></div>
</div>
<div id="high-yielders-delimiter" class="section level2">
<h2><span class="header-section-number">2.4</span> High yielders delimiter</h2>
<p>For cluster analysis, I keep only high yielders i.e. yield 65% quantile cutter for each cultivar. The <code>cutQ</code> table contains the yield delimiter for each cultivar. Then, this table is used to add the variable <code>yieldClass</code> to <code>leaf_clust_df</code>. <code>HY</code> and <code>LY</code> stand for high yield and low yield respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cutQ &lt;-<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Cultivar) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(RendVendable) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, quantile, <span class="dt">probs=</span><span class="fl">0.65</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">rv_cut =</span> RendVendable)</code></pre></div>
<pre><code>## Adding missing grouping variables: `Cultivar`</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">leaf_clust_df &lt;-<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(cutQ, <span class="dt">by =</span> <span class="st">&quot;Cultivar&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yieldClass =</span> forcats<span class="op">::</span><span class="kw">fct_relevel</span>(<span class="kw">ifelse</span>(RendVendable <span class="op">&gt;=</span><span class="st"> </span>rv_cut, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;LY&quot;</span>), <span class="st">&quot;LY&quot;</span>))</code></pre></div>
<p>For sake of verification, I compute average yield per yieldClass.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meanYield =<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(yieldClass) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(RendVendable) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise_if</span>(is.numeric, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Adding missing grouping variables: `yieldClass`</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meanYield</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   yieldClass RendVendable
##   &lt;fct&gt;             &lt;dbl&gt;
## 1 LY                 25.8
## 2 HY                 40.5
## 3 &lt;NA&gt;              NaN</code></pre>
<p>Average marketable yield is 40.48 Mg ha-1 for high yielders and 24.78 Mg ha^-1 for low yielders. In comparison, average potato tuber yields in 2017 in Canada and in Québec were respectively 40 Mg ha^-1 and 38.4 Mg ha^-1.</p>
</div>
<div id="clr-centroids-computation" class="section level2">
<h2><span class="header-section-number">2.5</span> <code>clr</code> centroids computation</h2>
<p>Compositional data transformation is done in the loaded file. I keep only clr-transformed coordinates for high yielders, at 10 % blossom (AnalyseFoliaireStade = 10% fleur) in the next chunk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYielders_df &lt;-<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">isNA =</span> <span class="kw">apply</span>(.[<span class="kw">c</span>(clr_no, cultivarAndyield)], <span class="dv">1</span>, anyNA)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is10pcf =</span> AnalyseFoliaireStade <span class="op">==</span><span class="st"> &quot;10% fleur&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>isNA <span class="op">&amp;</span><span class="st"> </span>is10pcf <span class="op">&amp;</span><span class="st"> </span>yieldClass <span class="op">==</span><span class="st"> &quot;HY&quot;</span> <span class="op">&amp;</span><span class="st"> </span>NoEssai <span class="op">!=</span><span class="st"> &quot;2&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(keys_col, clr_no, cultivarAndyield)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">droplevels</span>()
<span class="kw">nrow</span>(highYielders_df)</code></pre></div>
<pre><code>## [1] 1334</code></pre>
<p>So, 1334 lines of observations (samples) will be used for potato cultivars clustering. I Check how many rows of data are they for each cultivar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">percentage &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">with</span>(highYielders_df, <span class="kw">prop.table</span>(<span class="kw">table</span>(Cultivar)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dv">2</span>)
distribution &lt;-<span class="st"> </span><span class="kw">with</span>(highYielders_df, <span class="kw">cbind</span>(<span class="dt">numHY =</span> <span class="kw">table</span>(Cultivar), <span class="dt">percentage =</span> percentage))
distribution &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(distribution, <span class="kw">rownames</span>(distribution)))
<span class="kw">colnames</span>(distribution)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;Cultivar&quot;</span>
distribution<span class="op">$</span>numHY &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(distribution<span class="op">$</span>numHY)) <span class="co"># numHY = number of samples</span>
distribution<span class="op">$</span>percentage &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(distribution<span class="op">$</span>percentage))
distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(numHY)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="co"># arrange in descending order</span></code></pre></div>
<pre><code>##   numHY percentage  Cultivar
## 1   199      14.92  Superior
## 2   197      14.77  Goldrush
## 3   127       9.52   FL 1207
## 4   119       8.92 Chieftain
## 5    88       6.60  Atlantic</code></pre>
<p>Some cultivars are well represented, like Superior and Goldrush. Let’s compute number of cultivars and trials in the data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data.frame</span>(<span class="dt">numb_cultivars =</span> <span class="kw">n_distinct</span>(highYielders_df<span class="op">$</span>Cultivar, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
           <span class="dt">numb_trials =</span> <span class="kw">n_distinct</span>(highYielders_df<span class="op">$</span>NoEssai, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##   numb_cultivars numb_trials
## 1             47         151</code></pre>
<p>I create a table with cultivars, maturity classes and computed median clr values i.e., clr centroids.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYielders_clr &lt;-<span class="st"> </span>highYielders_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Cultivar, Maturity5) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Cultivar, Maturity5, <span class="kw">starts_with</span>(<span class="st">&quot;clr&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">list</span>(median))
highYielders_clr</code></pre></div>
<pre><code>## # A tibble: 47 x 8
## # Groups:   Cultivar [47]
##    Cultivar    Maturity5        clr_N clr_P clr_K clr_Mg clr_Ca clr_Fv
##    &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 AC Belmont  early            0.701 -2.02 0.664  -1.64 -1.11    3.47
##  2 AC Chaleur  early            0.696 -1.97 0.349  -1.54 -1.04    3.51
##  3 Amandine    mid-season       0.519 -2.29 0.557  -1.62 -0.696   3.53
##  4 Ambra       mid-season       0.713 -1.98 0.275  -1.39 -1.08    3.46
##  5 Andover     early mid-season 0.872 -2.17 0.738  -2.28 -0.808   3.57
##  6 Aquilon     mid-season       0.783 -1.86 0.387  -1.83 -0.901   3.48
##  7 Argos       late             0.767 -1.77 0.570  -1.70 -1.28    3.43
##  8 Atlantic    mid-season       0.784 -1.87 0.155  -1.50 -1.09    3.56
##  9 Bijou Rouge early            0.942 -1.93 0.563  -1.93 -1.12    3.61
## 10 Carolina    early            0.598 -2.19 0.131  -1.34 -0.837   3.63
## # ... with 37 more rows</code></pre>
<p>I use multivariate outliers detection technic to identify outliers with a criterion of detection limit of 0.975 by cultivar only if cultivars contain at leat 20 rows. If less than 20 rows, all rows are kept. The new data frame will be used for discriminant analysis. I call it <code>lda_df</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYielders_df_IO &lt;-<span class="st"> </span>highYielders_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Cultivar) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;clr&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">do</span>({
    <span class="cf">if</span> (<span class="kw">nrow</span>(.) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
      IO =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(.))
    } <span class="cf">else</span> {
      IO =<span class="st"> </span><span class="kw">sign1</span>(.[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">qcrit=</span><span class="fl">0.975</span>)<span class="op">$</span>wfinal01
    }
    <span class="kw">cbind</span>(.,IO)
  })

lda_df &lt;-<span class="st"> </span>highYielders_df_IO <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">filter</span>(IO <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">droplevels</span>()
<span class="kw">nrow</span>(lda_df)</code></pre></div>
<pre><code>## [1] 1196</code></pre>
<p>Hence, <code>\r nrow(highYielders_df)-nrow(lda_df)</code> outliers have been discarded from the analysis. The remaining data frame contains <code>\r n_distinct(lda_df$Cultivar, na.rm = TRUE)</code> cultivars from <code>\r n_distinct(lda_df$NoEssai, na.rm = TRUE)</code> trials.</p>
</div>
<div id="axis-reduction" class="section level2">
<h2><span class="header-section-number">2.6</span> Axis reduction</h2>
<p>Leaves composition data are compositionnal data (non-negative and summing to unity) so are multivariate. As argued by <a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a> It is not possible to draw such a diagram on paper with more than two or eventually three dimensions, however, even though it is a perfectly valid mathematical construct. For the purpose of analysis, I will project the multidimensional scatter diagram onto bivariate graphs whose axes are known to be of particular interest. The axes of these graphs are chosen to represent a large fraction of the variability of the multidimensional <code>N-P-K-Mg-Ca-Fv</code> data matrix, in a space with reduced (i.e. lower) dimensionality relative to the original data set. With the next chunks, I perform a duality diagram (or <a href="http://pbil.univ-lyon1.fr/ade4/ade4-html/dudi.html">dudi</a>) PCA (priciple component analysis) and store scores and loadings. I also filter the data frame so that cultivars with less than 5 occurences will be masked on the resulting biplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca_leaf &lt;-<span class="st"> </span><span class="kw">dudi.pca</span>(lda_df[clr_no], <span class="dt">scannf =</span> <span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">FALSE</span>)
lda_leaf &lt;-<span class="st"> </span><span class="kw">discrimin</span>(<span class="dt">dudi =</span> pca_leaf, <span class="dt">fac =</span> <span class="kw">factor</span>(lda_df<span class="op">$</span>Cultivar), <span class="dt">scannf =</span> <span class="ot">FALSE</span>)
lda_leaf_score =<span class="st"> </span>lda_leaf<span class="op">$</span>li
lda_leaf_loading =<span class="st"> </span>lda_leaf<span class="op">$</span>fa</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lda_df<span class="op">$</span>Cultivar &lt;-<span class="st"> </span><span class="kw">factor</span>(lda_df<span class="op">$</span>Cultivar)
lda_leaf_group &lt;-<span class="st"> </span>lda_df<span class="op">$</span>Cultivar
n_cultivar &lt;-<span class="st"> </span><span class="kw">table</span>(lda_df<span class="op">$</span>Cultivar)
<span class="co"># Do not schow Cultivars whose number of occurrences is &lt; 5</span>
n_filter &lt;-<span class="st"> </span>lda_leaf_group <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(n_cultivar[n_cultivar <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>])
filter_cultivars &lt;-<span class="st"> </span><span class="kw">names</span>(n_cultivar[n_cultivar <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>])
lda_df_filter &lt;-<span class="st"> </span>lda_df[n_filter, ]</code></pre></div>
<p>I can plot the tThe distance biplot as result of discriminant analysis. I use a custom function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">6</span>, <span class="dt">repr.plot.height =</span> <span class="dv">6</span>)
<span class="kw">plot_lda</span>(<span class="dt">score =</span> lda_leaf_score[n_filter, ],
         <span class="dt">loading =</span> lda_leaf_loading[n_filter, ],
         <span class="dt">group =</span> lda_leaf_group[n_filter],
         <span class="dt">ell_dev =</span> <span class="ot">FALSE</span>, 
         <span class="dt">ell_err =</span> <span class="ot">FALSE</span>, <span class="co">#TRUE, </span>
         <span class="dt">scale_load =</span> <span class="fl">0.5</span>,
         <span class="dt">level =</span> <span class="fl">0.95</span>,
         <span class="dt">legend =</span> <span class="ot">FALSE</span>,
         <span class="dt">label =</span> <span class="ot">TRUE</span>,
         <span class="dt">transparency =</span> <span class="fl">0.3</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">3.5</span>, <span class="dv">3</span>),
         <span class="dt">points =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:distance-biplot"></span>
<img src="2019_Bookdown_files/figure-html/distance-biplot-1.png" alt="Discriminant distance biplot of potato cultivars." width="100%" />
<p class="caption">
Figure 2.1: Discriminant distance biplot of potato cultivars.
</p>
</div>
<p>The first discriminant axis (<code>DS1</code>) is formed mainly by Mg, K and N. The second discriminant axis (<code>DS2</code>) is driven mainly by the Fv, K and weakely by Ca. I perform cluster analysis in next subsection.</p>
</div>
<div id="cascade-k-means-clustering" class="section level2">
<h2><span class="header-section-number">2.7</span> Cascade K Means clustering</h2>
<p>What is cascade K Means Clustering? It is an an unsupervised learning algorithm inspired by its similar <a href="https://www.r-bloggers.com/k-means-clustering-in-r/">K Means clustering</a> both trying to cluster data based on their similarity. There is no outcome to be predicted. The algorithm just tries to find patterns in the data. In k means clustering, we have to specify the number of clusters we want the data to be grouped into. In cascade K means method, we give a minimum and a maximum number of cluster wanted. The algorithm randomly assigns each observation to a cluster, and finds the centroid of each cluster. Then, the algorithm iterates through two steps:</p>
<ol style="list-style-type: decimal">
<li>reassign data points to the cluster whose centroid is closest,</li>
<li>Calculate new centroid of each cluster.</li>
</ol>
<p>These two steps are repeated till the within cluster variation cannot be reduced any further. The within cluster variation is calculated as the sum of the euclidean distance between the data points and their respective cluster centroids.</p>
<p>I use the high yielders clr centroids (medians) for cultivars in a next data frame which is the same as <code>highYielders_clr</code> without maturity classes, and <code>Calinski-Harabasz (1974) criterion (package vegan)</code> for clustering.The chunk also plots the process results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYieldersCentroids &lt;-<span class="st"> </span>highYielders_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Cultivar) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;clr&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">list</span>(median))
<span class="kw">set.seed</span>(<span class="dv">5773</span>)
highYieldersKmeans &lt;-<span class="st"> </span><span class="kw">cascadeKM</span>(highYieldersCentroids[, <span class="op">-</span><span class="dv">1</span>], 
                                <span class="dt">inf.gr =</span> <span class="dv">3</span>, <span class="dt">sup.gr =</span> <span class="dv">8</span>, <span class="dt">criterion =</span> <span class="st">&quot;ssi&quot;</span>)
<span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">6</span>, <span class="dt">repr.plot.height =</span> <span class="dv">4</span>)
<span class="kw">plot</span>(highYieldersKmeans) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:clustering"></span>
<img src="2019_Bookdown_files/figure-html/clustering-1.png" alt="K-means partitions comparison (calinski criterion)." width="100%" />
<p class="caption">
Figure 2.2: K-means partitions comparison (calinski criterion).
</p>
</div>
<p>The red dot of the right hand side graph shows 3 optimal clustering partitions which is the inferior limit I gave to the process. I check the partitions data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYieldersKmeans<span class="op">$</span>partition <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<pre><code>##   3 groups 4 groups 5 groups 6 groups 7 groups 8 groups
## 1        1        3        1        1        4        3
## 2        3        2        3        4        6        4
## 3        2        1        5        5        7        5
## 4        3        2        3        4        6        8
## 5        1        4        4        6        5        2
## 6        1        4        1        1        4        3</code></pre>
<p>I consider <code>6 groups</code> established from clustering (<code>...</code>) corresponding to the second column. I can use the reference of the column or its name <code>6 groups</code> directly. I add it up to the centroids data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">highYieldersCentroids<span class="op">$</span>kgroup &lt;-<span class="st"> </span>highYieldersKmeans<span class="op">$</span>partition[, <span class="st">&quot;6 groups&quot;</span>]</code></pre></div>
<p>I compute discriminant scores centroïdes for cultivars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lda_centroids &lt;-<span class="st"> </span>lda_leaf_score <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> lda_leaf_group) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">list</span>(mean))</code></pre></div>
<p>Plot Cultivar groups in LDA with a custom function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">6</span>, <span class="dt">repr.plot.height =</span> <span class="dv">6</span>)
<span class="kw">plot_lda</span>(<span class="dt">score=</span>lda_leaf_score[n_filter, ],
         <span class="dt">loading=</span>lda_leaf_loading[n_filter, ],
         <span class="dt">group =</span> lda_leaf_group[n_filter],
         <span class="dt">ell_dev=</span><span class="ot">FALSE</span>, 
         <span class="dt">ell_err=</span> <span class="ot">FALSE</span>, <span class="co">#TRUE, </span>
         <span class="dt">scale_load =</span> <span class="fl">0.4</span>,
         <span class="dt">level=</span><span class="fl">0.95</span>,
         <span class="dt">legend=</span><span class="ot">FALSE</span>,
         <span class="dt">label=</span><span class="ot">TRUE</span>,
         <span class="dt">transparency=</span><span class="fl">0.4</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>),
         <span class="dt">points=</span>F)
<span class="co"># colour dots for groups (or clusters)</span>
col =<span class="st"> </span><span class="kw">factor</span>(highYieldersCentroids[highYieldersCentroids<span class="op">$</span>Cultivar <span class="op">%in%</span><span class="st"> </span>filter_cultivars, <span class="st">&#39;kgroup&#39;</span>][[<span class="dv">1</span>]])

<span class="co"># remove the cultivar column</span>
<span class="kw">points</span>(lda_centroids[lda_centroids<span class="op">$</span>group <span class="op">%in%</span><span class="st"> </span>filter_cultivars, <span class="kw">c</span>(<span class="st">&#39;DS1&#39;</span>, <span class="st">&#39;DS2&#39;</span>)], 
       <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> col, <span class="dt">cex =</span> <span class="fl">0.9</span>)

<span class="kw">legend</span>(<span class="fl">1.3</span>, <span class="dv">4</span>, 
       <span class="dt">legend =</span> <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;cluster&#39;</span>, <span class="kw">nlevels</span>(col)), <span class="kw">as.numeric</span>(<span class="kw">levels</span>(col))), 
       <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="kw">unique</span>(col), <span class="dt">cex =</span> <span class="fl">0.9</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:d-biplot-2"></span>
<img src="2019_Bookdown_files/figure-html/d-biplot-2-1.png" alt="Discriminant distance biplot of potato cultivars showing ionomics groups." width="100%" />
<p class="caption">
Figure 2.3: Discriminant distance biplot of potato cultivars showing ionomics groups.
</p>
</div>
<p>It’s a bit difficult to colour cultivar name in the plot with the custom function. I use functions from packages <code>ggplot2</code>, <code>ggrepel</code> and <code>plotly</code> instead. New intermediate data frames are created for this purpose.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cultivars_filtre &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Cultivar =</span> filter_cultivars, <span class="dt">i_group=</span>col)

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">score =</span> lda_leaf_score[n_filter, ],
    <span class="dt">loadings =</span> lda_leaf_loading[n_filter,],
    <span class="dt">Cultivar =</span> lda_leaf_group[n_filter]
                )
df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(cultivars_filtre, <span class="dt">by=</span><span class="st">&quot;Cultivar&quot;</span>)</code></pre></div>
<pre><code>## Warning: Column `Cultivar` joining factors with different levels, coercing
## to character vector</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<pre><code>##   score.DS1 score.DS2 loadings.DS1 loadings.DS2   Cultivar i_group
## 1 1.0366780 1.0148643    1.9989657   -0.1477988 AC Belmont       1
## 2 0.5973192 1.5106837   -0.1794520    0.7415188 AC Belmont       1
## 3 0.7195584 1.3363729    2.0112615    2.4201235 AC Belmont       1
## 4 0.5343385 0.7486986   -2.3193130    1.3696071 AC Belmont       1
## 5 0.4140698 1.1521065    0.2748907    1.3266327 AC Belmont       1
## 6 0.3382326 1.1899525   -1.7863528   -5.7100833 AC Belmont       1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">centroids =<span class="st"> </span>lda_centroids[lda_centroids<span class="op">$</span>group <span class="op">%in%</span><span class="st"> </span>filter_cultivars, ]
<span class="kw">names</span>(centroids)[<span class="kw">match</span>(<span class="st">&quot;group&quot;</span>, <span class="kw">names</span>(centroids))] &lt;-<span class="st"> &quot;Cultivar&quot;</span>
centroids &lt;-<span class="st"> </span>centroids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(cultivars_filtre, <span class="dt">by=</span><span class="st">&quot;Cultivar&quot;</span>)
centroids <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Cultivar      DS1     DS2 i_group
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  
## 1 AC Belmont  0.122  1.02   1      
## 2 AC Chaleur -0.543  0.124  4      
## 3 Andover     1.93  -0.0478 6      
## 4 Aquilon     0.238  0.240  1      
## 5 Argos       0.157  0.859  2      
## 6 Atlantic   -1.22  -0.413  4</code></pre>
<p>The chunk below plots discriminant biplot with colours corresponding to ionomics groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">9</span>, <span class="dt">repr.plot.height =</span> <span class="dv">9</span>)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(centroids, <span class="kw">aes</span>(DS1, DS2, <span class="dt">label =</span> Cultivar, <span class="dt">col=</span>i_group)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">12</span>) <span class="op">+</span>
<span class="st">  </span><span class="co">#scale_color_manual(values=c(&quot;red&quot;, &quot;magenta&quot;, &quot;blue&quot;, &quot;black&quot;)) + </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Arial&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">12</span>))

<span class="co"># Add discriminant loadings using geom_segment() and arrow()</span>
x=<span class="dv">0</span>; y=<span class="dv">0</span>; labels =<span class="st"> </span><span class="kw">c</span>(clr_no, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">nrow</span>(df)<span class="op">-</span><span class="kw">length</span>(clr_no)))
g <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>df, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">xend=</span>x<span class="op">+</span>loadings.DS1, <span class="dt">yend=</span>y<span class="op">+</span>loadings.DS2), 
                 <span class="dt">arrow=</span><span class="kw">arrow</span>(), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;grey80&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">data=</span>df, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>loadings.DS1, <span class="dt">y=</span>loadings.DS2, <span class="dt">label=</span>labels), 
              <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">linetype=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">xintercept=</span><span class="dv">0</span>), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">linetype=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.line=</span><span class="kw">element_blank</span>())</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gg-biplot"></span>
<img src="2019_Bookdown_files/figure-html/gg-biplot-1.png" alt="Discriminant biplot and cluster analysis result of potato cultivars." width="100%" />
<p class="caption">
Figure 2.4: Discriminant biplot and cluster analysis result of potato cultivars.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ggsave(&quot;images/cultivar_clust.png&quot;, width=10, height=8, dpi = 300)</span></code></pre></div>
<p>I push cultivars yield cut-off and ionomics groups in the initial data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ionomicGroup &lt;-<span class="st"> </span><span class="kw">data.frame</span>(lda_centroids[, <span class="dv">1</span>], 
                           <span class="dt">ionomicGroup =</span> <span class="kw">factor</span>(highYieldersKmeans<span class="op">$</span>partition[, <span class="st">&quot;6 groups&quot;</span>]))
<span class="kw">colnames</span>(ionomicGroup)[<span class="kw">colnames</span>(ionomicGroup)<span class="op">==</span><span class="st">&quot;group&quot;</span>] &lt;-<span class="st"> &quot;Cultivar&quot;</span>
cutQ &lt;-<span class="st"> </span>cutQ[<span class="op">-</span><span class="dv">1</span>, ] <span class="co"># to discard missing cultivar names</span>
<span class="kw">colnames</span>(cutQ)[<span class="kw">which</span>(<span class="kw">names</span>(cutQ) <span class="op">==</span><span class="st"> &quot;rv_cut&quot;</span>)] &lt;-<span class="st"> &quot;yieldCutoff&quot;</span>
cutQ_ig &lt;-<span class="st"> </span>cutQ <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(ionomicGroup, <span class="dt">by =</span> <span class="st">&quot;Cultivar&quot;</span>)

leaf_clust_df &lt;-<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">left_join</span>(<span class="dt">y =</span> cutQ_ig, <span class="dt">by =</span> <span class="st">&#39;Cultivar&#39;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>rv_cut)</code></pre></div>
</div>
<div id="arranging-data-for-machine-learning" class="section level2">
<h2><span class="header-section-number">2.8</span> Arranging data for Machine Learning</h2>
<p>I select useful columns for the next chapter (<a href="Chapter-Modeling.html#Chapter-Modeling">3</a>) and save the new table as <code>dfml.csv</code>. I conserve only <code>complete cases</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;yieldCutoff&#39;</span>, <span class="st">&#39;yieldClass&#39;</span>, <span class="st">&#39;ionomicGroup&#39;</span>)
dfml &lt;-<span class="st"> </span>leaf_clust_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="kw">c</span>(keys_col, clr_no, cultivarAndyield, new_col, <span class="st">&#39;AnalyseFoliaireStade&#39;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">isNA =</span> <span class="kw">apply</span>(.[<span class="kw">c</span>(clr_no, cultivarAndyield)], <span class="dv">1</span>, anyNA)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is10pcf =</span> AnalyseFoliaireStade <span class="op">==</span><span class="st"> &quot;10% fleur&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>isNA <span class="op">&amp;</span><span class="st"> </span>is10pcf <span class="op">&amp;</span><span class="st"> </span>NoEssai <span class="op">!=</span><span class="st"> &quot;2&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(AnalyseFoliaireStade, isNA, is10pcf)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">droplevels</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))
<span class="kw">nrow</span>(dfml)</code></pre></div>
<pre><code>## [1] 3382</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(dfml, <span class="st">&quot;output/dfml.csv&quot;</span>)</code></pre></div>
<p>Hence, the data table contains 3382 for the next chapter (Machine learning).</p>
</div>
<div id="clr-x-ionomics-groups-interactions-effects" class="section level2">
<h2><span class="header-section-number">2.9</span> clr X ionomics groups interactions effects</h2>
<p>I use a linear mixed effect model to assess the effect of clr coordinates on tubers marketable yield between ionomics groups. This last subsection perfom this analysis by extracting and ploting the interaction coefficients of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfml<span class="op">$</span>Cultivar &lt;-<span class="st"> </span><span class="kw">factor</span>(dfml<span class="op">$</span>Cultivar)
<span class="co">#dfml$Maturity5 &lt;- relevel(dfml$Maturity5, ref = &quot;late&quot;)</span>
dfml<span class="op">$</span>NoEssai &lt;-<span class="st"> </span><span class="kw">factor</span>(dfml<span class="op">$</span>NoEssai)
<span class="kw">colnames</span>(dfml)[<span class="kw">colnames</span>(dfml)<span class="op">==</span><span class="st">&quot;ionomicGroup&quot;</span>] &lt;-<span class="st"> &quot;group_i&quot;</span>
dfml<span class="op">$</span>group_i &lt;-<span class="st"> </span><span class="kw">factor</span>(dfml<span class="op">$</span>group_i)

clr_no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clr_N&quot;</span>, <span class="st">&quot;clr_P&quot;</span>, <span class="st">&quot;clr_K&quot;</span>, <span class="st">&quot;clr_Ca&quot;</span>, <span class="st">&quot;clr_Mg&quot;</span>, <span class="st">&quot;clr_Fv&quot;</span>)
clrNo &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clrN&quot;</span>, <span class="st">&quot;clrP&quot;</span>, <span class="st">&quot;clrK&quot;</span>, <span class="st">&quot;clrCa&quot;</span>, <span class="st">&quot;clrMg&quot;</span>, <span class="st">&quot;clrFv&quot;</span>) <span class="co"># for plot</span>
<span class="kw">colnames</span>(dfml)[<span class="kw">which</span>(<span class="kw">names</span>(dfml) <span class="op">%in%</span><span class="st"> </span>clr_no)] &lt;-<span class="st"> </span>clrNo</code></pre></div>
<p>I scale clr coordinates before ajusting linear mixed model. Discard the filling value to deal with singularity problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfml.sc &lt;-<span class="st"> </span>dfml  <span class="co"># copy</span>
dfml.sc[, clrNo] &lt;-<span class="st"> </span><span class="kw">apply</span>(dfml.sc[, clrNo], <span class="dv">2</span>, scale)
used_clr =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clrN&quot;</span>, <span class="st">&quot;clrP&quot;</span>, <span class="st">&quot;clrK&quot;</span>, <span class="st">&quot;clrCa&quot;</span>, <span class="st">&quot;clrMg&quot;</span>) <span class="co"># without &quot;clr_Fv&quot;</span>

lmm &lt;-<span class="st"> </span><span class="kw">lme</span>(RendVendable <span class="op">~</span><span class="st"> </span>(clrN <span class="op">+</span><span class="st"> </span>clrP <span class="op">+</span><span class="st"> </span>clrK <span class="op">+</span><span class="st"> </span>clrCa <span class="op">+</span><span class="st"> </span>clrMg)<span class="op">:</span>group_i, 
            <span class="dt">data=</span>dfml.sc, 
            <span class="dt">random=</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>NoEssai)

pseudoR2 =<span class="st"> </span><span class="kw">rsq</span>(dfml.sc<span class="op">$</span>RendVendable, <span class="kw">predict</span>(lmm))
pseudoR2</code></pre></div>
<pre><code>## [1] 0.7369405</code></pre>
<p>The next code extracts the interactions coefficients of the model and their p-values (pv) matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pv &lt;-<span class="st"> </span><span class="kw">summary</span>(lmm)<span class="op">$</span>tTable[<span class="op">-</span><span class="dv">1</span>,]
pv</code></pre></div>
<pre><code>##                      Value  Std.Error   DF     t-value      p-value
## clrN:group_i1   5.60218758  0.5496386 3151 10.19249231 5.031902e-24
## clrN:group_i2   4.30397894  0.7336432 3151  5.86658313 4.909999e-09
## clrN:group_i3   1.21367104  5.7005996 3151  0.21290235 8.314169e-01
## clrN:group_i4   8.54331361  0.6871694 3151 12.43261589 1.116381e-34
## clrN:group_i5   6.34147974  2.2943571 3151  2.76394630 5.743895e-03
## clrN:group_i6   0.29174441  1.0533480 3151  0.27696868 7.818223e-01
## clrP:group_i1   4.28649269  0.5866128 3151  7.30719260 3.440135e-13
## clrP:group_i2   4.51000950  1.1678025 3151  3.86196270 1.147409e-04
## clrP:group_i3   1.16001050  8.6354916 3151  0.13433057 8.931498e-01
## clrP:group_i4   8.64313859  0.9100128 3151  9.49782120 4.095742e-21
## clrP:group_i5   7.23955939  3.0563011 3151  2.36873239 1.790915e-02
## clrP:group_i6  -0.24376218  1.5811871 3151 -0.15416404 8.774903e-01
## clrK:group_i1   4.75027835  0.7993461 3151  5.94270558 3.109982e-09
## clrK:group_i2   3.20803689  1.2493573 3151  2.56774983 1.028182e-02
## clrK:group_i3   5.08994127  8.2298083 3151  0.61847629 5.363061e-01
## clrK:group_i4   8.79256304  0.9535030 3151  9.22132688 5.224314e-20
## clrK:group_i5   8.01431075  3.3899685 3151  2.36412542 1.813302e-02
## clrK:group_i6  -1.27526027  2.1219199 3151 -0.60099360 5.478875e-01
## clrCa:group_i1  6.39980521  0.7295692 3151  8.77203264 2.819484e-18
## clrCa:group_i2  4.01681887  1.1949631 3151  3.36145847 7.845625e-04
## clrCa:group_i3  4.19209068 14.6386227 3151  0.28637193 7.746121e-01
## clrCa:group_i4  9.84671173  0.9540141 3151 10.32134813 1.383904e-24
## clrCa:group_i5  9.26754687  2.7848346 3151  3.32786259 8.851996e-04
## clrCa:group_i6  0.06304187  1.8499322 3151  0.03407794 9.728172e-01
## clrMg:group_i1  3.89799879  0.5854246 3151  6.65841358 3.252874e-11
## clrMg:group_i2  1.70676455  1.0999128 3151  1.55172717 1.208279e-01
## clrMg:group_i3 -1.70032991  7.2872569 3151 -0.23332921 8.155209e-01
## clrMg:group_i4  7.53469298  0.8977348 3151  8.39300553 7.061592e-17
## clrMg:group_i5  7.96978108  3.0177230 3151  2.64099158 8.307192e-03
## clrMg:group_i6 -0.41568533  1.7171650 3151 -0.24207652 8.087366e-01</code></pre>
<p>Then, I extract their confident intervals, and process data for the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">interval &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Estimate =</span> <span class="kw">intervals</span>(lmm)<span class="op">$</span>fixed[<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>],
                    <span class="dt">LL =</span> <span class="kw">intervals</span>(lmm)<span class="op">$</span>fixed[<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], 
                    <span class="dt">UL =</span> <span class="kw">intervals</span>(lmm)<span class="op">$</span>fixed[<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]) 

interval<span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&#39;NA&#39;</span>, <span class="kw">nrow</span>(interval))
interval<span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">intervals</span>(lmm)<span class="op">$</span>fixed)[<span class="op">-</span><span class="dv">1</span>]
interval<span class="op">$</span>ionomic_group &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">paste</span>(<span class="st">&quot;group&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">nlevels</span>(dfml<span class="op">$</span>group_i)), <span class="kw">length</span>(clrNo)<span class="op">-</span><span class="dv">1</span>)
interval<span class="op">$</span>used_clr &lt;-<span class="st"> </span><span class="kw">rep</span>(used_clr, <span class="dt">each =</span> <span class="kw">nlevels</span>(dfml<span class="op">$</span>group_i))

interval<span class="op">$</span>pvalue &lt;-<span class="st"> </span>pv[,<span class="st">&quot;p-value&quot;</span>]
interval<span class="op">$</span>is_significant =<span class="st"> </span><span class="kw">ifelse</span>(interval<span class="op">$</span>pvalue <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>,
                                      <span class="st">&#39;P &lt; 0.05&#39;</span>,
                                      <span class="st">&#39;P &gt; 0.05&#39;</span>)
interval</code></pre></div>
<pre><code>## # A tibble: 30 x 8
##    Estimate     LL    UL variable ionomic_group used_clr   pvalue
##       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt;
##  1    5.60    4.52  6.68 clrN:gr~ group 1       clrN     5.03e-24
##  2    4.30    2.87  5.74 clrN:gr~ group 2       clrN     4.91e- 9
##  3    1.21   -9.96 12.4  clrN:gr~ group 3       clrN     8.31e- 1
##  4    8.54    7.20  9.89 clrN:gr~ group 4       clrN     1.12e-34
##  5    6.34    1.84 10.8  clrN:gr~ group 5       clrN     5.74e- 3
##  6    0.292  -1.77  2.36 clrN:gr~ group 6       clrN     7.82e- 1
##  7    4.29    3.14  5.44 clrP:gr~ group 1       clrP     3.44e-13
##  8    4.51    2.22  6.80 clrP:gr~ group 2       clrP     1.15e- 4
##  9    1.16  -15.8  18.1  clrP:gr~ group 3       clrP     8.93e- 1
## 10    8.64    6.86 10.4  clrP:gr~ group 4       clrP     4.10e-21
## # ... with 20 more rows, and 1 more variable: is_significant &lt;chr&gt;</code></pre>
<p>This cell plots the interaction coefficients and their confident intervals using ggplot2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">4</span>, <span class="dt">repr.plot.height =</span> <span class="dv">8</span>)
gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> interval, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Estimate, <span class="dt">y =</span> used_clr, <span class="dt">color=</span>is_significant)) <span class="op">+</span>
<span class="st">         </span><span class="kw">facet_grid</span>(ionomic_group <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span><span class="co">#, scales = &#39;free&#39;, space = &#39;free&#39;) +</span>
<span class="st">         </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">         </span><span class="kw">geom_segment</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> LL, <span class="dt">xend =</span> UL, <span class="dt">y =</span> used_clr, <span class="dt">yend =</span> used_clr)) <span class="op">+</span>
<span class="st">         </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">         </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Coefficient&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">         </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">         </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Arial&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">12</span>))
gg <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="co">#, legend.position = &#39;bottom&#39;)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:coefficients"></span>
<img src="2019_Bookdown_files/figure-html/coefficients-1.png" alt="Effect of ionome perturbation on marketable yield as illustrated by a linear mixed effect model." width="100%" />
<p class="caption">
Figure 2.5: Effect of ionome perturbation on marketable yield as illustrated by a linear mixed effect model.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ggsave(&quot;images/coef_lmm.tiff&quot;, width = 5, height = 5, dpi = 300)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Chapter-Modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["2019_Bookdown.pdf", "2019_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
